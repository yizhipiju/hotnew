(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-60c7a7e1"],{"4d63":function(e,t,n){var r=n("83ab"),s=n("da84"),a=n("94ca"),c=n("7156"),i=n("9bf2").f,o=n("241c").f,u=n("44e7"),h=n("ad6d"),l=n("9f7f"),d=n("6eeb"),f=n("d039"),p=n("69f3").set,g=n("2626"),m=n("b622"),v=m("match"),x=s.RegExp,w=x.prototype,b=/a/g,S=/a/g,y=new x(b)!==b,T=l.UNSUPPORTED_Y,k=r&&a("RegExp",!y||T||f((function(){return S[v]=!1,x(b)!=b||x(S)==S||"/a/i"!=x(b,"i")})));if(k){var O=function(e,t){var n,r=this instanceof O,s=u(e),a=void 0===t;if(!r&&s&&e.constructor===O&&a)return e;y?s&&!a&&(e=e.source):e instanceof O&&(a&&(t=h.call(e)),e=e.source),T&&(n=!!t&&t.indexOf("y")>-1,n&&(t=t.replace(/y/g,"")));var i=c(y?new x(e,t):x(e,t),r?this:w,O);return T&&n&&p(i,{sticky:n}),i},_=function(e){e in O||i(O,e,{configurable:!0,get:function(){return x[e]},set:function(t){x[e]=t}})},R=o(x),H=0;while(R.length>H)_(R[H++]);w.constructor=O,O.prototype=w,d(s,"RegExp",O)}g("RegExp")},"609e":function(e,t,n){"use strict";var r=n("aa5d"),s=n.n(r);s.a},aa5d:function(e,t,n){},efe3:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"search-container"},[n("form",{attrs:{action:"/"}},[n("van-search",{attrs:{placeholder:"请输入搜索关键词","show-action":"",shape:"round",background:"#4fc08d"},on:{search:function(t){return e.onSearch(e.searchText)},cancel:function(t){return e.$router.back()},focus:function(t){e.isResultShow=!1}},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}})],1),e.isResultShow?n("search-result",{attrs:{"search-text":e.searchText}}):e.searchText?n("search-suggestion",{attrs:{"search-text":e.searchText},on:{search:e.onSearch}}):n("search-history",{attrs:{"search-histories":e.searchHistories},on:{search:e.onSearch,"update-history":function(t){e.searchHistories=t}}})],1)},s=[],a=(n("c975"),n("a434"),n("96cf"),n("1da1")),c=n("5530"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"search-suggestion"},e._l(e.suggestions,(function(t,r){return n("van-cell",{key:r,attrs:{icon:"search"},on:{click:function(n){return e.$emit("search",t)}}},[n("div",{attrs:{slot:"title"},domProps:{innerHTML:e._s(e.highlight(t))},slot:"title"})])})),1)},o=[],u=(n("4d63"),n("ac1f"),n("25f0"),n("5319"),n("b775")),h=function(e){return Object(u["a"])({method:"GET",url:"/app/v1_0/suggestion",params:{q:e}})},l=function(e){return Object(u["a"])({method:"GET",url:"/app/v1_0/search",params:e})},d=n("2ef0"),f={name:"SearchSuggestion",components:{},props:{searchText:{type:String,required:!0}},data:function(){return{suggestions:[]}},computed:{},watch:{searchText:{handler:Object(d["debounce"])(Object(a["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,h(this.searchText);case 2:t=e.sent,n=t.data,this.suggestions=n.data.options;case 5:case"end":return e.stop()}}),e,this)}))),200),immediate:!0}},created:function(){},mounted:function(){},methods:{highlight:function(e){return e.replace(new RegExp(this.searchText,"gi"),'<span style="color:orange">'.concat(this.searchText,"</span>"))}}},p=f,g=n("2877"),m=Object(g["a"])(p,i,o,!1,null,"75d85804",null),v=m.exports,x=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"search-history"},[n("van-cell",{attrs:{title:"搜索历史"}},[e.isDeleteShow?n("div",[n("span",{on:{click:function(t){return e.$emit("update-history",[])}}},[e._v("全部删除")]),e._v(" "),n("span",{on:{click:function(t){e.isDeleteShow=!1}}},[e._v("完成")])]):n("van-icon",{attrs:{name:"delete"},on:{click:function(t){e.isDeleteShow=!0}}})],1),e._l(e.searchHistories,(function(t,r){return n("van-cell",{key:r,attrs:{title:t},on:{click:function(n){return e.onDelete(t,r)}}},[n("van-icon",{directives:[{name:"show",rawName:"v-show",value:e.isDeleteShow,expression:"isDeleteShow"}],attrs:{name:"close"}})],1)}))],2)},w=[],b={name:"SearchHistory",components:{},props:{searchHistories:{type:Array,required:!0}},data:function(){return{isDeleteShow:!1}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{onDelete:function(e,t){this.isDeleteShow?this.searchHistories.splice(t,1):this.$emit("search",e)}}},S=b,y=Object(g["a"])(S,x,w,!1,null,"81821644",null),T=y.exports,k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"search-result"},[n("van-list",{attrs:{finished:e.finished,"finished-text":"没有更多了"},on:{load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.list,(function(e,t){return n("van-cell",{key:t,attrs:{title:e.title}})})),1)],1)},O=[],_=n("2909"),R={name:"SearchResult",components:{},props:{searchText:{type:String,required:!0}},data:function(){return{list:[],loading:!1,finished:!1,page:1,perPage:10}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{onLoad:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n,r,s,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,l({page:e.page,per_page:e.perPage,q:e.searchText});case 2:r=t.sent,s=r.data,a=s.data.results,(n=e.list).push.apply(n,Object(_["a"])(a)),e.loading=!1,a.length?e.page++:e.finished=!0;case 8:case"end":return t.stop()}}),t)})))()}}},H=R,j=(n("609e"),Object(g["a"])(H,k,O,!1,null,"6a64d710",null)),E=j.exports,D=n("5d2d"),$=n("2f62"),q={name:"SearchIndex",components:{SearchResult:E,SearchSuggestion:v,SearchHistory:T},props:{},data:function(){return{searchText:"",isResultShow:!1,searchHistories:Object(D["a"])("search-histories")||[]}},computed:Object(c["a"])({},Object($["b"])(["user"])),watch:{searchHistories:function(){Object(D["b"])("search-histories",this.searchHistories)}},created:function(){this.loadSearchHistories()},mounted:function(){},methods:{onSearch:function(e){this.searchText=e;var t=this.searchHistories.indexOf(e);-1!==t&&this.searchHistories.splice(t,1),this.searchHistories.unshift(e),this.isResultShow=!0},loadSearchHistories:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=Object(D["a"])("search-histories")||[],e.searchHistories=n;case 2:case"end":return t.stop()}}),t)})))()}}},P=q,C=Object(g["a"])(P,r,s,!1,null,"66fe1368",null);t["default"]=C.exports}}]);