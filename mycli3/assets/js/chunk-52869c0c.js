(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-52869c0c"],{"1b25":function(e,n,t){},"6eca":function(e,n,t){"use strict";var r=t("1b25"),o=t.n(r);o.a},"9ed6":function(e,n,t){"use strict";t.r(n);var r=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"login-container"},[t("van-nav-bar",{staticClass:"app-nav-bar",attrs:{title:"注册 / 登录","left-arrow":""},on:{"click-left":function(n){return e.$router.back()}}}),t("van-form",{ref:"login-form",attrs:{"show-error":!1,"validate-first":"","show-error-message":!1},on:{submit:e.onLogin,failed:e.onFailed}},[t("van-field",{attrs:{"icon-prefix":"hotnew","left-icon":"shouji",center:"",placeholder:"请输入手机号",name:"mobile",rules:e.formRules.mobile},model:{value:e.user.mobile,callback:function(n){e.$set(e.user,"mobile",n)},expression:"user.mobile"}}),t("van-field",{attrs:{clearable:"","icon-prefix":"hotnew","left-icon":"yanzhengma",center:"",placeholder:"请输入验证码",name:"code",rules:e.formRules.code},scopedSlots:e._u([{key:"button",fn:function(){return[e.isCountDownShow?t("van-count-down",{attrs:{time:6e4,format:"ss s"},on:{finish:function(n){e.isCountDownShow=!1}}}):t("van-button",{attrs:{round:"",loading:e.inSendSmsLoading,size:"mini",type:"primary"},on:{click:function(n){return n.preventDefault(),e.onSendSms(n)}}},[e._v("发送验证码")])]},proxy:!0}]),model:{value:e.user.code,callback:function(n){e.$set(e.user,"code",n)},expression:"user.code"}}),t("div",{staticClass:"login-btn-wrap"},[t("van-button",{staticClass:"login-btn",attrs:{type:"info",block:""}},[e._v("登录")])],1)],1)],1)},o=[],a=(t("96cf"),t("1da1")),s=t("c24f"),i=t("d399"),u={name:"LoginIndex",data:function(){return{user:{mobile:"18365443062",code:"246810"},formRules:{mobile:[{required:!0,message:"请输入手机号"},{pattern:/^1[3|5|7|8|9]\d{9}$/,message:"手机号格式错误"}],code:[{required:!0,message:"请填写验证码"},{pattern:/^\d{6}$/,message:"验证码格式错误"}]},isCountDownShow:!1,inSendSmsLoading:!1}},methods:{onLogin:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var t,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i["a"].loading({message:"登录中...",forbidClick:!0,duration:0}),n.prev=1,n.next=4,Object(s["f"])(e.user);case 4:t=n.sent,r=t.data,i["a"].success("登陆成功"),console.log(r.data),e.$store.commit("setUser",r.data),e.$store.commit("removeCachePage","LayoutIndex"),e.$router.push(e.$route.query.redirect||"/"),n.next=16;break;case 13:n.prev=13,n.t0=n["catch"](1),i["a"].fail("登录失败,手机号或验证码错误");case 16:case"end":return n.stop()}}),n,null,[[1,13]])})))()},onFailed:function(e){e.errors[0]&&this.$toast({message:e.errors[0].message,position:"top"})},onSendSms:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var t;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.$refs["login-form"].validate("mobile");case 3:return e.inSendSmsLoading=!0,n.next=6,Object(s["g"])(e.user.mobile);case 6:e.isCountDownShow=!0,n.next=14;break;case 9:n.prev=9,n.t0=n["catch"](0),t="",t=n.t0&&n.t0.response&&429===n.t0.response.status?"发送太频繁了,请稍后重试":"mobile"===n.t0.name?n.t0.message:"发送失败，请稍后重试",e.$toast({message:t,position:"top"});case 14:e.inSendSmsLoading=!1;case 15:case"end":return n.stop()}}),n,null,[[0,9]])})))()}}},c=u,l=(t("6eca"),t("2877")),d=Object(l["a"])(c,r,o,!1,null,null,null);n["default"]=d.exports},c24f:function(e,n,t){"use strict";t.d(n,"f",(function(){return o})),t.d(n,"g",(function(){return a})),t.d(n,"c",(function(){return s})),t.d(n,"d",(function(){return i})),t.d(n,"a",(function(){return u})),t.d(n,"b",(function(){return c})),t.d(n,"e",(function(){return l})),t.d(n,"i",(function(){return d})),t.d(n,"h",(function(){return f}));var r=t("b775"),o=function(e){return Object(r["a"])({method:"POST",url:"/app/v1_0/authorizations",data:e})},a=function(e){return Object(r["a"])({method:"GET",url:"/app/v1_0/sms/codes/".concat(e)})},s=function(){return Object(r["a"])({method:"GET",url:"/app/v1_0/user"})},i=function(){return Object(r["a"])({method:"GET",url:"/app/v1_0/user/channels"})},u=function(e){return Object(r["a"])({method:"POST",url:"/app/v1_0/user/followings",data:{target:e}})},c=function(e){return Object(r["a"])({method:"DELETE",url:"/app/v1_0/user/followings/".concat(e)})},l=function(){return Object(r["a"])({method:"GET",url:"/app/v1_0/user/profile"})},d=function(e){return Object(r["a"])({method:"PATCH",url:"/app/v1_0/user/profile",data:e})},f=function(e){return Object(r["a"])({method:"PATCH",url:"/app/v1_0/user/photo",data:e})}}}]);